# Официальный модуль приема платежей Robokassa для Drupal Commerce (Alpha version)
Данный модуль позволяет добавить на сайт способ оплаты через Робокассу.
Для корректной работы модуля необходима регистрация в сервисе.

Порядок регистрации описан в [документации Robokassa](https://docs.robokassa.ru/#7844)

### Возможности
* Передача состава товаров в заказе для отправки чека клиенту и в налоговую (54-ФЗ);
* Приём платежей в тестовом режиме;
* Автоматическая смена статуса заказа;
* ~~Автоматическое формирование итогового чека;~~
* ~~Поддержка продажи через iframe~~
* ~~Поддержка отправки второго чека и маркировки товара~~
* ~~Поддержка продавцов из Казахстана~~

### Совместимость
Drupal 8;

Commerce 2.x;

### Установка через панель управления

"Управление" -> "Расширения" -> "Установить новый модуль" -> "Установить".

### Ручная установка

Добавить commerce_robokassa в папку modules

### Настройка модуля

1. Перейти в настройки модуля "Commerce" -> "Платёжные шлюзы" -> "Редактировать".
Выбрать Robokassa и активировать модуль.
2. Зайти в настройки модуля и указать обязательные данные:
    * Название
    * Название отображения
    * Режим
    * Идентификатор клиента
    * Пароль №1
    * Пароль №2
    * Hash type согласно выбранному в ЛКК Робокассы
    * Система налогообложения
    * Признак способа расчёта
    * Признак способа расчёта
    * Налоговая ставка

    Затем сохранить введенные параметры.

3. В личном кабинете Robokassa ("мои магазины" - "настройки" - "технические настройки") указать:
    * Result Url: /commerce_robokassa/second_rule/result
    * Success Url: /commerce_robokassa/commerce_robokassa/success
    * Fail Url: /commerce_robokassa/second_rule/fail

### Уведомления об оплате

Уведомление об оплате Robokassa отправляет автоматически, после успешного совершения платежа, на адрес Result URL, который был скопирован из настроек модуля и указан в технических настройках магазина. После получения уведомления, заказ в CMS изменит статус на тот, который указан в поле "Статус заказа после оплаты".
При правильной настройке Robokassa самостоятельно сообщит в модуль статус оплаты, после чего статус заказа изменится согласно настройкам.

### Changelog
 = 0.0.1 =

Релиз альфа-версии плагина
